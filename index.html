<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
	<title>Portal :: Sky Drifters</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="../css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	<link href="../css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
</head>
<body>
    <!--<div style="display: none;" id="Authlevel"></div>-->
    <div id="loginmodal" class="modal modal-fixed-footer">
		<div class="modal-content">
			<h4>Enter member access code:</h4>
			<div class="row">
				<form class="col s12">
					<div class="row">
						<div class="input-field col s6">
							<i class="material-icons prefix">account_circle</i>
							<input id="icon_prefix" type="text" class="validate level">
							<label for="icon_prefix" data-error="Wrong Format" data-success="OK">Access Level</label>
						</div>
						<div class="input-field col s6">
							<i class="material-icons prefix">vpn_key</i>
							<input id="icon_telephone" type="password" class="validate code">
							<label for="icon_telephone" data-error="Bad Format" data-success="OK">Passcode</label>
						</div>
					</div>
				</form>
				<h5>What is this?</h5>
				<p class="light">
				In order to reduce information leaks and increase security you must enter the generated code available to all Sky Drifters. If you are part of a special group such as WANMED or the FSC you may find your code in another designated, private chat.
				</p>
			</div>
		</div>
        <div class="modal-footer">
			<a href="#!" onclick="logIn()" class="modal-action modal-close green-text waves-effect waves-light btn-flat">Go</a>
			<a href="#!" class="modal-action modal-close red-text waves-effect waves-light btn-flat">Cancel</a>
		</div>
	</div>

    <div class="nav-fixed">
    <nav class="nav-extended cyan darken-1" id="main-nav">
        <div class="nav-wrapper container">
            <a href="#" id="logo-container" class="center brand-logo"><img alt="Logo" height="55" width="55" src="https://1suddo2kmul411y9l03duj9d-wpengine.netdna-ssl.com/wp-content/uploads/alliance-emblem/71539169cd0df00250f44eff3e30d6f5.svg"></a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
            <!--<ul id="nav-mobile" class="right hide-on-med-and-down">
                <li><a href="https://skydrifters.github.io/">Public Area</a></li>
            </ul>-->
            <ul class="side-nav" id="mobile-demo">
                <li><a class="navtab" href="#ann1">Announcments</a></li>
                <li><a class="navtab" href="#alli2">Alliance Information</a></li>
                <li><a class="navtab" href="#opp3">Opportunities</a></li>
                <li><a class="navtab" href="https://skydrifters.github.io">Public Page</a></li>
                <li><a class="navtab" href="#edit4">Edit</a></li>
            </ul>

            <ul class="center tabs tabs-transparent tabs-fixed-width hide-on-med-and-down">
                <li class="tab"><a class="active" href="#ann1">Announcments</a></li>
                <li class="tab"><a href="#alli2">Alliance Information</a></li>
                <li class="tab disabled"><a href="#edit4">    </a></li>
                <li class="tab"><a href="#opp3">Opportunities</a></li>
                <li class="tab"><a target="_self" href="https://skydrifters.github.io">Public Page</a></li>
                <li class="tab disabled"><a href="#edit4">Edit</a></li>
            </ul>
        </div>
    </nav>
    </div>
    <div id="ann1" class="col s12">

    </div>
    <div id="alli2" class="col s12"></div>
    <div id="opp3" class="col s12"></div>
    <div id="edit4" class="col s12"></div>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="../js/materialize.js"></script>
    <script src="../js/init.js"></script>
    <script>
        var level = "Public";

        $(document).ready(function () {
            // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
            $('.modal').modal();
        });

        function getQueryVariable(variable) {
            var query = window.location.search.substring(1);
            var vars = query.split("&");
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split("=");
                if (pair[0] == variable) { return pair[1]; }
            }
            return (false);
        }

        function populateAnn(level) {
            if (level == "Allied Member") {
                levelX = "public";
            } else if (level == "Chief" || level == "Command" || level == "Moderator" || level == "Member") {
                levelX = "private";
            } else {
                levelX = "public";
            }
            $.ajax({
                url: "https://skydriftersauth.000webhostapp.com/ann.php?authlevel=" + levelX,
                contentType: "xml",
                method: "GET",
                success: function (data) {
                    console.log(data);
                    $(data).find("item").each(function () {
                        var auth = $(this).attr("authLevel");
                        var author = $(this).find("author").text();
                        var title = $(this).find("title").text();
                        var content = $(this).find("content").html();
                        $("#ann1").append("<h1>Data got sucessfully");
                    });
                },
                error: function (data) {
                    console.log("Error: " + data);
                }
            });
        }

        function populateInfo(level) {

        }

        function populateOpp(level) {

        }

        function populateEdit(level) {

        }

        function logIn() {
            var levelX = $(".level").val();
            var key = $(".code").val();
            console.log(key);
            $.ajax({
                url: "https://skydriftersauth.000webhostapp.com/sdauth.php?lvl=" + level + "&var=" + key,
                method: "GET",
                dataType: "text",
                success: function (data) {
                    console.log(data);
                    if (data == 1) {
                        console.log("Succesfully Verified");
                        level = levelX
                        populateAnn(level);
                    } else {
                        console.log("Not Verified");
                        $("#main-nav").toggleClass("cyan");
                        $("#main-nav").toggleClass("red");
                    }
                },
                error: function (data) {
                    console.log("Error verifying." + data)
                }
            });
        }
    </script>
</body>
</html>