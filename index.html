<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
	<title>Portal :: Sky Drifters</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="../css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	<link href="../css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    <style> 
		html, body{
			background: url("../background3.jpg") no-repeat center center fixed; 
			-webkit-background-size: cover;
			-moz-background-size: cover;
			-o-background-size: cover;
			background-size: cover;
		}
        
        .img-circle {
            border-radius: 50%;
            background: #00acc1;
            padding: 5px;
            height: 60px;
            width:  60px;
        }
    </style>
</head>
<body>
    <div style="display: none;" id="Authlevel">
    
    </div>
    
      <!-- MORE MODAL -->
  <div id="modal1" class="modal modal-fixed-footer">
    <div class="modal-content">
      <h4 id="more-title"></h4>
      <p id="more-content"></p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat ">Close</a>
    </div>
  </div>
          

    <div class="nav-fixed">
    <nav class="nav-extended cyan darken-1" id="main-nav">
        <div class="nav-wrapper container">
            <a href="#" id="logo-container" class="center brand-logo"><img class="img-circle" alt="Logo" height="55" width="55" src="https://1suddo2kmul411y9l03duj9d-wpengine.netdna-ssl.com/wp-content/uploads/alliance-emblem/71539169cd0df00250f44eff3e30d6f5.svg"></a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
            <!--<ul id="nav-mobile" class="right hide-on-med-and-down">
                <li><a href="https://skydrifters.github.io/">Public Area</a></li>
            </ul>-->
            <ul class="side-nav" id="mobile-demo">
                <li><a class="navtab" href="#ann1">Announcments</a></li>
                <li><a class="navtab" href="#alli2">Alliance Information</a></li>
                <li><a class="navtab" href="#opp3">Opportunities</a></li>
                <li><a class="navtab" href="https://skydrifters.github.io">Public Page</a></li>
                <li><a class="navtab" href="#edit4">Edit</a></li>
            </ul>

            <ul class="center tabs tabs-transparent tabs-fixed-width hide-on-med-and-down">
                <li class="tab"><a class="active" href="#ann1">Announcments</a></li>
                <li class="tab"><a href="#alli2">Alliance Information</a></li>
                <li class="tab disabled"><a href="#edit4"></a></li>
                <li class="tab"><a href="#opp3">Opportunities</a></li>
                <li class="tab"><a target="_self" href="https://skydrifters.github.io">Public Page</a></li>
                <li class="tab disabled"><a href="#edit4">Edit</a></li>
            </ul>
        </div>
    </nav>
    </div>
    <div class="container">
        <div id="ann1" class="col s12" style="padding-top: 50px">
        </div>
        <div id="alli2" class="col s12"></div>
        <div id="opp3" class="col s12"></div>
        <div id="edit4" class="col s12"></div>
    </div>
    
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="../js/materialize.js"></script>
    <script src="../js/init.js"></script>
    <script>
        var level = "Public";

        function getQueryVariable(variable) {
            var query = window.location.search.substring(1);
            var vars = query.split("&");
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split("=");
                if (pair[0] == variable) { return pair[1]; }
            }
            return (false);
        }

        function populateAnn() {
            level = $("#authlvl").text();
            pass = $("#pass").text();
            levelX = "private";
            $.ajax({
                url: "https://skydriftersauth.000webhostapp.com/ann.php?authlevel=" + levelX,
                dataType: "xml",
                method: "GET",
                success: function (data) {
                    console.log(data);
                    $(data).find("item").each(function () {
                        var auth = $(this).attr("authLevel");
                        var author = $(this).find("author").text();
                        var title = $(this).find("title").text();
                        var content = $(this).find("content").html();
                        content = content.substr(0, 50) + "\u2026";
                        $("#ann1").append("<div class='row'>\
          <div class='col s12 m6'>\
            <div class='card blue-grey darken-1'>\
              <div class='card-content white-text'>\
                <span class='card-title'>" + title + " by "+author+"</span>\
                <p>" + content + "</p>\
              </div>\
              <div class='card-action'>\
                <a class='modal-trigger waves-effect waves-light btn' onclick='$(\"#more-title\").text(\""+title+"\"); $(\"#more-content\").empty(); $(\"#more-content\").append(\""+content+"\")' href='#modal1'>Modal</a>\
              </div>\
            </div>\
          </div>\
        </div>");
                    });
                },
                error: function (data) {
                    console.log("Error: " + data);
                }
            });
        }

        function populateInfo(level) {

        }

        function populateOpp(level) {

        }

        function populateEdit(level) {

        }

        $(document).ready(function () {
            level = getQueryVariable("level");
            pass = getQueryVariable("key");
            $.ajax({
                url: "https://skydriftersauth.000webhostapp.com/sdauth.php?lvl=" + level + "&var=" + pass,
                method: "GET",
                dataType: "text",
                success: function (data) {
                    if (data == 1) {
                        $("#Authlevel").append("<strong id='status'>Verified</strong>");
                        $("#Authlevel").append("<strong id='authlvl'>" + level + "</strong>");
                        $("#Authlevel").append("<strong id='pass'>" + pass + "</strong>");
                        populateAnn()
                    } else if (data == 0) {
                        $("#Authlevel").append("Not Verified");
                    } else {
                        $("#Authlevel").append("Error in verification");
                    }
                },
                error: function (data) {
                    console.log("Error: " + data)
                }
            })
        });

    </script>
</body>
</html>